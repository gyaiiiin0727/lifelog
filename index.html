<!DOCTYPE html>

<html lang="ja">
<head>

<!-- PWA: ã‚­ãƒ£ãƒƒã‚·ãƒ¥åˆ¶å¾¡ã¯ Service Worker å´ã§ç®¡ç†ã—ã¾ã™ -->
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes" name="viewport"/>

<!-- ===== PWA Settings (v40.18) ===== -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#111111">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="ãƒ©ã‚¤ãƒ•ãƒ­ã‚°">
<link rel="apple-touch-icon" href="icon-192.png">
<meta name="mobile-web-app-capable" content="yes">

<title>ãƒ©ã‚¤ãƒ•ãƒ­ã‚°ã‚¢ãƒ—ãƒª v35.0 - å®Œå…¨ä¿®æ­£ç‰ˆï¼ˆwindowå…¬é–‹ä¿®æ­£ï¼‰ [v41.2.1]</title>
<style>
/* ===== v40.9 ç›®æ¨™ã‚«ãƒ¼ãƒ‰ã‚’â€œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚«ãƒ¼ãƒ‰â€é¢¨ã« ===== */
/* ã­ã‚‰ã„: ç›®æ¨™åã‚’ä¸»å½¹ã« / ã‚«ãƒ†ã‚´ãƒªã¯ãƒãƒƒã‚¸åŒ– / ã‚«ãƒ¼ãƒ‰ã®æƒ…å ±è¨­è¨ˆã‚’æ•´ç† */

/* ç›®æ¨™ãƒªã‚¹ãƒˆå…¨ä½“ã®ä½™ç™½ */
#goals .goals-list-section{
  margin-top: 14px !important;
}

/* 1ä»¶ã®ã‚«ãƒ¼ãƒ‰ */
#goals .goal-item{
  position: relative !important;
  padding: 16px 16px 14px 16px !important;
  margin: 12px 0 !important;
  border-radius: 14px !important;
  border: 2px solid #111 !important;
  background: #fff !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.08) !important;
  overflow: hidden !important;
}

/* å·¦å´ã®ã‚¢ã‚¯ã‚»ãƒ³ãƒˆãƒãƒ¼ */
#goals .goal-item::before{
  content: "" !important;
  position: absolute !important;
  left: 0 !important;
  top: 0 !important;
  bottom: 0 !important;
  width: 6px !important;
  background: #111 !important;
  opacity: 0.12 !important;
}

/* hoverï¼ˆPCï¼‰ */
#goals .goal-item:hover{
  transform: translateY(-1px) !important;
  box-shadow: 0 10px 26px rgba(0,0,0,0.10) !important;
}

/* å®Œäº†ã‚«ãƒ¼ãƒ‰ */
#goals .goal-item.completed{
  opacity: 0.85 !important;
  background: #fbfbfb !important;
}
#goals .goal-item.completed::before{
  opacity: 0.06 !important;
}

/* ãƒ˜ãƒƒãƒ€ãƒ¼: ã‚¿ã‚¤ãƒˆãƒ«ã¨ã‚«ãƒ†ã‚´ãƒª */
#goals .goal-header{
  display: flex !important;
  align-items: center !important;
  gap: 10px !important;
  margin-bottom: 12px !important;
  flex-wrap: wrap !important; /* é•·ã„ç›®æ¨™åã§ã‚‚å´©ã‚Œã«ãã */
}

/* ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’å°‘ã—å¤§ãã */
#goals .goal-checkbox{
  width: 22px !important;
  height: 22px !important;
  flex: 0 0 auto !important;
}

/* ç›®æ¨™åï¼ˆ=ä¸»å½¹ï¼‰ */
#goals .goal-text{
  flex: 1 1 auto !important;
  min-width: 160px !important;
  font-size: 17px !important;
  font-weight: 900 !important;
  line-height: 1.25 !important;
  color: #111 !important;
  letter-spacing: 0.2px !important;
}

/* å®Œäº†æ™‚ã®ç›®æ¨™å */
#goals .goal-item.completed .goal-text{
  text-decoration: line-through !important;
  color: #777 !important;
}

/* ã‚«ãƒ†ã‚´ãƒªï¼ˆ=æ§ãˆã‚ãƒãƒƒã‚¸ï¼‰ */
#goals .goal-category,
#goals .category-badge{
  margin-left: auto !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
  padding: 6px 10px !important;
  border-radius: 999px !important;
  border: 2px solid rgba(17,17,17,0.12) !important;
  background: #f6f6f6 !important;
  font-size: 12px !important;
  font-weight: 800 !important;
  color: #333 !important;
  white-space: nowrap !important;
}

/* é€²æ—è¡¨ç¤ºï¼ˆLv/ï¼…ï¼‰ã‚’è¦‹å‡ºã—ã£ã½ã */
#goals .goal-progress,
#goals .goal-level,
#goals .goal-level-display{
  font-weight: 900 !important;
}

/* ã‚«ãƒ¼ãƒ‰å†…ã®æ“ä½œç¾¤ã‚’æ•´åˆ—ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆã«åŠ¹ãï¼‰ */
#goals .goal-actions,
#goals .goal-controls,
#goals .goal-buttons{
  display: flex !important;
  gap: 10px !important;
  align-items: center !important;
  flex-wrap: wrap !important;
  margin-top: 10px !important;
}

/* ã‚¹ãƒãƒ›æœ€é©åŒ– */
@media (max-width: 480px){
  #goals .goal-item{
    padding: 14px 14px 12px 14px !important;
    border-radius: 12px !important;
  }
  #goals .goal-text{
    font-size: 16px !important;
    min-width: 140px !important;
  }
  #goals .goal-category,
  #goals .category-badge{
    padding: 5px 9px !important;
    font-size: 11px !important;
  }
}

@media (max-width: 480px){
  .money-category-buttons{
    grid-template-columns: repeat(2, 1fr);
  }
}

</style>











<style>
/* ===== v40.12 Fix: ã‚¯ã‚¤ãƒƒã‚¯è¨˜éŒ²ã®é«˜ã•ï¼†ä¸­å¤®å¯„ã›ã‚’ç¢ºå®Ÿã«é©ç”¨ =====
   æ–‡å­—åŒ–ã‘ä¿®æ­£ã®æ›´æ–°ã§CSSé †åºãŒå¤‰ã‚ã‚Šã€æ—¢å­˜ã‚¹ã‚¿ã‚¤ãƒ«ã«ä¸Šæ›¸ãã•ã‚ŒãŸå¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€
   ã‚ˆã‚Šå¼·ã„ã‚»ãƒ¬ã‚¯ã‚¿ + !important ã§å†é©ç”¨ã—ã¾ã™ã€‚
*/

/* ã‚¯ã‚¤ãƒƒã‚¯è¨˜éŒ²ã®ã€Œã‚«ãƒ¼ãƒ‰ã€è‡ªä½“ï¼ˆè¤‡æ•°å€™è£œï¼‰ */
#home #quickRecordSection,
#home .quick-record-card,
#home .quick-record,
#home .quick-record-section,
#home .quick-record-container,
#home .quick-record-panel,
#home .quick-record-box,
#home .dash-quick-record,
#home .dashboard-quick-record {
  min-height: 110px !important;     /* ã ã„ãŸã„åŠåˆ† */
  padding: 14px 14px !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: center !important; /* ç¸¦ä¸­å¤® */
}

/* ã‚‚ã—å†…å´ãƒ©ãƒƒãƒ‘ãƒ¼ãŒã‚ã‚‹å ´åˆã‚‚ä¸­å¤®å¯„ã› */
#home #quickRecordSection > *,
#home .quick-record-card > *,
#home .quick-record > *,
#home .quick-record-section > * {
  width: 100%;
}

/* ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆâš¡ ã‚¯ã‚¤ãƒƒã‚¯è¨˜éŒ²ï¼‰ */
#home #quickRecordSection h3,
#home .quick-record-card h3,
#home .quick-record h3,
#home .quick-record-section h3 {
  margin: 0 0 10px 0 !important;
  text-align: center !important;
  font-size: 15px !important;
  font-weight: 800 !important;
}

/* è¡Œå‹•/ãŠé‡‘ã®ãƒˆã‚°ãƒ«ã®è¦ªï¼ˆå€™è£œï¼‰ */
#home #quickModeToggle,
#home .quick-mode-toggle,
#home .quick-mode-switch,
#home .quick-record-toggle,
#home .quick-toggle {
  display: flex !important;
  justify-content: center !important;
  align-items: center !important;
  gap: 12px !important;
}

/* ãƒˆã‚°ãƒ«ãŒ input+label å½¢å¼ã§ã‚‚ä¸­å¤®ã«å¯„ã›ã‚‹ */
#home #quickModeToggle label,
#home .quick-mode-toggle label {
  margin: 0 !important;
}

/* ãƒœã‚¿ãƒ³ */
#home #quickModeToggle button,
#home .quick-mode-toggle button,
#home .quick-mode-switch button,
#home .quick-record-toggle button,
#home .quick-toggle button {
  min-width: 92px !important;
  padding: 9px 12px !important;
  font-size: 13px !important;
  line-height: 1.1 !important;
}

/* ãƒœã‚¿ãƒ³ãŒ .quick-btn ã®å ´åˆ */
#home #quickModeToggle .quick-btn,
#home .quick-mode-toggle .quick-btn,
#home .quick-mode-switch .quick-btn {
  min-width: 92px !important;
  padding: 9px 12px !important;
  font-size: 13px !important;
}

/* ã‚¹ãƒãƒ›ã•ã‚‰ã«è©°ã‚ã‚‹ */
@media (max-width: 480px) {
  #home #quickRecordSection,
  #home .quick-record-card,
  #home .quick-record,
  #home .quick-record-section,
  #home .quick-record-container,
  #home .quick-record-panel,
  #home .quick-record-box,
  #home .dash-quick-record,
  #home .dashboard-quick-record {
    min-height: 96px !important;
    padding: 12px 12px !important;
  }

  #home #quickModeToggle button,
  #home .quick-mode-toggle button,
  #home .quick-mode-switch button,
  #home .quick-record-toggle button,
  #home .quick-toggle button,
  #home #quickModeToggle .quick-btn,
  #home .quick-mode-toggle .quick-btn,
  #home .quick-mode-switch .quick-btn {
    min-width: 86px !important;
    padding: 8px 10px !important;
    font-size: 12px !important;
  }
}

@media (max-width: 480px){
  .money-category-buttons{
    grid-template-columns: repeat(2, 1fr);
  }
}

</style>



<style>
/* ===== v40.13 Design Refresh: æ ç·šå‰Šé™¤ / è§’ä¸¸ã‚’å››è§’ã« / èƒŒæ™¯ã§åŒºåˆ‡ã‚‹ ===== */

/* 1) æ ç·šï¼ˆborderï¼‰ã‚’å‰Šé™¤ */
.log-item,
.goal-item,
.category-summary,
.journal-log-item,
.stat-card,
.summary-stat-item,
.chart-container,
.modal-content,
.dashboard-card,
.dashboard-journal,
.today-tasks-section,
.task-item,
.recent-item,
.ai-section,
.data-section,
.data-btn,
.category-btn,
.quick-button,
.mood-button,
.qr-category-btn,
.calendar-day,
.simple-calendar,
.simple-summary,
.simple-chart,
.simple-details {
  border: none !important;
}

/* å…¥åŠ›ç³»ã¯ä¸‹ç·šã ã‘æ®‹ã™ */
.text-input,
input, select, textarea {
  border: none !important;
  border-bottom: 1px solid #ddd !important;
}

/* 2) è§’ä¸¸ã‚’å››è§’ã«ï¼ˆãƒ¢ãƒ¼ãƒ€ãƒ«ã¨ä¸€éƒ¨ãƒœã‚¿ãƒ³ã¯å°‘ã—æ®‹ã™ï¼‰ */
.log-item,
.goal-item,
.card,
.dashboard-card,
.dashboard-journal,
.today-tasks-section,
.stat-card,
.summary-stat-item,
.chart-container,
.ai-section,
.ai-hero,
.tab-button,
.text-input,
input, select, textarea,
.calendar-day,
.progress-bar-container,
.progress-bar-fill,
.simple-calendar,
.simple-summary,
.simple-chart,
.simple-details,
.recent-item {
  border-radius: 0 !important;
}

.modal-content,
.quick-btn,
.add-button,
.voice-button,
.category-btn,
.mood-button,
.qr-category-btn,
.simple-nav-btn {
  border-radius: 4px !important;
}

.category-badge,
.goal-category {
  border-radius: 2px !important;
}

/* 3) èƒŒæ™¯è‰²ã§ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’åŒºåˆ‡ã‚‹ */

/* ãƒ›ãƒ¼ãƒ  */
#home .dashboard-cards { background: #fafafa !important; padding: 16px !important; margin: 0 -20px !important; }
#home .today-tasks-section { background: #f5f7fa !important; }
#home .dashboard-journal { background: #f9fafb !important; }
#home .dashboard-recent { background: #fafafa !important; padding: 16px !important; }

/* è¡Œå‹• */
#activity .category-selection-section { background: #f8f9fa !important; }
#activity .logs-section { background: #fafafa !important; padding: 16px !important; margin-top: 20px !important; }
#activity .logs-section .log-item { background: #fff !important; margin-bottom: 8px !important; padding: 14px !important; }
#activity .logs-section .log-item:nth-child(odd) { background: #fdfdfd !important; }

/* ãŠé‡‘ */
#money .money-categories { background: #f8f9fa !important; padding: 16px !important; margin-bottom: 16px !important; }
#money .logs-section { background: #fafafa !important; padding: 16px !important; }

/* ã‚¸ãƒ£ãƒ¼ãƒŠãƒ« */
#journal .journal-dateblock { background: #f7f8fa !important; padding: 16px !important; }
#journal .mood-selector { background: #fafafa !important; }
#journal .journal-simple.card { background: #fff !important; }
#journal .journal-log { background: #f9fafb !important; }

/* ç›®æ¨™ */
#goals .goals-section { background: #f8f9fa !important; }
#goals .goals-list-section { background: #fafafa !important; padding: 16px !important; }
#goals .goals-progress-section { background: #f5f7fa !important; }
#goals .goal-item { background: #fff !important; }
#goals .goal-item:nth-child(odd) { background: #fdfdfd !important; }

/* ãƒ¬ãƒãƒ¼ãƒˆ */
#reportActivity .simple-summary { background: #f8f9fa !important; }
#reportActivity .simple-chart { background: #fafafa !important; }
#reportActivity .simple-details { background: #f5f7fa !important; }
#reportMoney .simple-summary { background: #f8f9fa !important; }
#reportMoney .simple-chart { background: #fafafa !important; }
#reportMoney .simple-details { background: #f5f7fa !important; }

/* AI */
#ai .ai-section { background: #fafafa !important; }
#ai .data-section { background: #f5f5f5 !important; }
#ai .data-section.premium { background: #fffef5 !important; }

/* 4) è¿½åŠ æ¨å¥¨èª¿æ•´ */
/* è¦‹å‡ºã—ä¸‹ç·šï¼ˆæ ç·šï¼‰ã®ä»£ã‚ã‚Šã«ä½™ç™½ã§åŒºåˆ‡ã‚‹ */
.section-title {
  border-bottom: none !important;
  padding-bottom: 8px !important;
  margin-bottom: 12px !important;
}

/* æ ç·šã®ä»£ã‚ã‚Šã«è–„ã„å½± */
.log-item,
.goal-item,
.dashboard-card,
.recent-item {
  box-shadow: 0 1px 3px rgba(0,0,0,0.04) !important;
}

/* hoveræ™‚ã¯èƒŒæ™¯è‰²ã§å¼·èª¿ */
.log-item:hover { background: #f5f5f5 !important; }
.goal-item:hover { background: #f8f8f8 !important; }
.dashboard-card:hover { background: #f5f5f5 !important; }

/* ã‚¿ãƒ–ãƒŠãƒ“ã®èƒŒæ™¯ãƒ•ã‚§ãƒ¼ãƒ‰ãŒç™½å›ºå®šã ã¨æ¿ã‚‹ã®ã§ã€ãƒ™ãƒ¼ã‚¹èƒŒæ™¯ã«åˆã‚ã›ã‚‹ */
.tab-nav-wrapper::before {
  background: linear-gradient(to right, #f7f7f7 0%, transparent 100%) !important;
}
.tab-nav-wrapper::after {
  background: linear-gradient(to left, #f7f7f7 0%, transparent 100%) !important;
}

@media (max-width: 480px){
  .money-category-buttons{
    grid-template-columns: repeat(2, 1fr);
  }
}

</style>



<style>
/* ===== v40.14 Fix: è§’ä¸¸ã‚’ã•ã‚‰ã«å¾¹åº•ã—ã¦å››è§’ã¸ ===== */

/* æœˆåˆ‡æ›¿ãƒŠãƒ“ï¼ˆç›®æ¨™ï¼‰ */
.goals-month-nav,
.goals-month-nav button,
#goals .month-nav,
#goals .month-nav button,
#goals .simple-nav,
#goals .simple-nav button,
.simple-nav-btn {
  border-radius: 0 !important;
}

/* ã€Œï¼‹ æ–°ã—ã„ç›®æ¨™ã‚’è¿½åŠ ã€ */
.add-goal-btn,
.add-goal-card,
.add-goal,
#goals .add-goal,
#goals .add-button {
  border-radius: 0 !important;
}

/* ç›®æ¨™ã‚«ãƒ¼ãƒ‰å…¨ä½“ */
.goal-item,
.goal-card,
.goal-project-card,
#goals .goal-item,
#goals .goal-card,
#goals .card {
  border-radius: 0 !important;
}

/* é€²æ—ãƒãƒ¼å¤–æ ãƒ»ä¸­èº« */
.progress-bar-container,
.progress-bar-fill,
#goals .progress-bar-container,
#goals .progress-bar-fill,
.progress-bar,
.progress-fill {
  border-radius: 0 !important;
}

/* ã‚«ãƒ†ã‚´ãƒªãƒãƒƒã‚¸ */
.goal-category,
.category-badge,
#goals .goal-category,
#goals .category-badge {
  border-radius: 0 !important;
}

/* Lvã‚»ãƒ¬ã‚¯ãƒˆãƒ»å…¥åŠ›æ¬„ãƒ»ãƒœã‚¿ãƒ³ï¼ˆç›®æ¨™ã‚«ãƒ¼ãƒ‰å†…ï¼‰ */
#goals select,
#goals input,
#goals button,
.goal-item select,
.goal-item input,
.goal-item button {
  border-radius: 0 !important;
}

/* å®Œäº†åˆ‡æ›¿ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³ï¼ˆã‚¯ãƒ©ã‚¹æºã‚Œå¯¾ç­–ï¼‰ */
.complete-toggle,
.delete-btn,
.btn-icon,
.goal-item .complete-toggle,
.goal-item .delete-btn {
  border-radius: 0 !important;
}

/* é€²æ—å±¥æ­´ãƒˆã‚°ãƒ« */
.goal-history-toggle,
#goals .goal-history-toggle,
#goals .history-toggle {
  border-radius: 0 !important;
}

/* ãƒ¬ãƒãƒ¼ãƒˆãƒ»ã‚µãƒãƒªãƒ¼ç³» */
.simple-summary,
.simple-chart,
.simple-details,
#reportActivity .simple-summary,
#reportActivity .simple-chart,
#reportActivity .simple-details,
#reportMoney .simple-summary,
#reportMoney .simple-chart,
#reportMoney .simple-details {
  border-radius: 0 !important;
}

/* ãƒ¢ãƒ¼ãƒ€ãƒ« */
.modal,
.modal-content,
#premiumModal,
#premiumModal .modal-content {
  border-radius: 0 !important;
}

/* ã‚¯ã‚¤ãƒƒã‚¯è¨˜éŒ² */
.dashboard-quick,
.quick-record-container,
.quick-record,
.quick-btn {
  border-radius: 0 !important;
}

/* ã‚¿ãƒ– */
.tab-button { border-radius: 0 !important; }

/* AIã‚¿ãƒ– */
.ai-section,
.data-section,
.data-btn,
.ai-hero {
  border-radius: 0 !important;
}

/* å½±ã‚‚ã‚·ãƒ£ãƒ¼ãƒ—ã«ï¼ˆæ ç·šãŒç„¡ã„ãƒ‡ã‚¶ã‚¤ãƒ³ã¨ç›¸æ€§è‰¯ãï¼‰ */
.goal-item,
.goal-card,
.dashboard-card,
.recent-item,
.log-item {
  box-shadow: 0 1px 2px rgba(0,0,0,0.05) !important;
}

@media (max-width: 480px){
  .money-category-buttons{
    grid-template-columns: repeat(2, 1fr);
  }
}

</style>


<style>
/* ===== v40.17 Journal UI: æ ç·šå‰Šé™¤ & è§’ä¸¸ã‚¼ãƒ­ ===== */

/* ã‚¸ãƒ£ãƒ¼ãƒŠãƒ«å…¨ä½“ã®ã‚«ãƒ¼ãƒ‰/ãƒ–ãƒ­ãƒƒã‚¯ã®æ ç·šã¨è§’ä¸¸ã‚’å¤–ã™ */
#journal .journal-dateblock,
#journal .mood-selector,
#journal .journal-simple.card,
#journal .journal-log,
#journal .journal-log-item,
#journal .card,
#journal .dashboard-card,
#journal .section,
#journal .section-card {
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
}

/* æ°—åˆ†ãƒœã‚¿ãƒ³ï¼ˆmoodï¼‰ã¨ãƒãƒƒãƒ—é¡ã®è§’ä¸¸ã‚’å¤–ã™ */
#journal .mood-button,
#journal .journal-chip,
#journal .journal-tag,
#journal .pill,
#journal .chip,
#journal button {
  border-radius: 0 !important;
}

/* å…¥åŠ›ï¼ˆtextarea / input / selectï¼‰ã®æ ç·šãƒ»è§’ä¸¸ã‚’å¤–ã™ï¼ˆä¸‹ç·šã ã‘æ®‹ã™ï¼‰ */
#journal input,
#journal select,
#journal textarea,
#journal .text-input {
  border: none !important;
  border-bottom: 1px solid #ddd !important;
  border-radius: 0 !important;
  box-shadow: none !important;
}

/* æ—¥ä»˜é¸æŠãƒ»ä¿å­˜ã¾ã‚ã‚Šã®ã‚³ãƒ³ãƒ†ãƒŠã‚‚ãƒ•ãƒ©ãƒƒãƒˆã« */
#journal .journal-header,
#journal .journal-header-inner,
#journal .journal-controls,
#journal .date-picker,
#journal .date-selector {
  border: none !important;
  border-radius: 0 !important;
  box-shadow: none !important;
}

/* ä½™ç™½ã¨èƒŒæ™¯ã ã‘ã§åŒºåˆ‡ã‚‹ï¼ˆè¦‹ã‚„ã™ã•æ‹…ä¿ï¼‰ */
#journal .journal-dateblock,
#journal .mood-selector,
#journal .journal-log {
  background: #fafafa !important;
}

#journal .journal-simple.card {
  background: #fff !important;
}

#journal .journal-log-item {
  background: #fff !important;
  margin-bottom: 8px !important;
  padding: 14px !important;
}

/* é»’ã„ãƒãƒ¼ï¼ˆéŸ³å£°å…¥åŠ›/AIã§æ•´ãˆã‚‹ï¼‰ãŒè§’ä¸¸ã«ãªã£ã¦ã„ã‚‹å ´åˆã®å¿µæŠ¼ã— */
#journal .voice-section,
#journal .voice-button,
#journal .ai-refine-button,
#journal .primary-button,
#journal .action-button {
  border-radius: 0 !important;
}

@media (max-width: 480px){
  .money-category-buttons{
    grid-template-columns: repeat(2, 1fr);
  }
}

</style>


<script>
// ===== PWA Service Worker registration (v40.18) =====
if ("serviceWorker" in navigator) {
  window.addEventListener("load", () => {
    navigator.serviceWorker.register("./sw.js").catch((e) => console.warn("SW registration failed:", e));
  });
}
</script>


<!-- ===== FAB (Floating Action Button) v1.0 ===== -->
<style>
/* FABã‚³ãƒ³ãƒ†ãƒŠ */
.fab-container {
  position: fixed;
  bottom: 24px;
  right: 12px; /* 24px â†’ 12px ã«å¤‰æ›´ï¼ˆã‚ˆã‚Šå³ã¸ï¼‰ */
  z-index: 9000;
  display: flex;
  flex-direction: column-reverse;
  align-items: flex-end; /* center â†’ flex-end ã«å¤‰æ›´ï¼ˆå³å¯„ã›ï¼‰ */
  gap: 12px;
}

/* ãƒ¡ã‚¤ãƒ³FABãƒœã‚¿ãƒ³ */
.fab-main {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  background: #111;
  border: none;
  color: #fff;
  font-size: 28px;
  cursor: pointer;
  box-shadow: 0 4px 16px rgba(0,0,0,0.3);
  transition: transform 0.3s ease, background 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.fab-main:hover { background: #333; }
.fab-main:active { transform: scale(0.95); }

/* é–‹ã„ãŸçŠ¶æ…‹ */
.fab-main.open {
  transform: rotate(45deg);
  background: #333;
}

/* ã‚µãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
.fab-menu {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 10px;
  opacity: 0;
  pointer-events: none;
  transform: translateY(20px);
  transition: opacity 0.25s ease, transform 0.25s ease;
}
.fab-menu.open {
  opacity: 1;
  pointer-events: auto;
  transform: translateY(0);
}

/* ã‚µãƒ–ãƒœã‚¿ãƒ³ */
.fab-sub {
  display: flex;
  align-items: center;
  gap: 10px;
  background: #fff;
  border: 2px solid #111;
  border-radius: 30px;
  padding: 12px 20px;
  cursor: pointer;
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  white-space: nowrap;
}
.fab-sub:hover { transform: translateX(-4px); box-shadow: 0 6px 20px rgba(0,0,0,0.2); }
.fab-sub:active { transform: scale(0.97); }

.fab-sub .fab-icon { font-size: 20px; }
.fab-sub .fab-label { font-size: 14px; font-weight: 700; color: #111; }

/* ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
.fab-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.3);
  z-index: 8999;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.25s ease;
}
.fab-overlay.open {
  opacity: 1;
  pointer-events: auto;
}

/* ãƒ›ãƒ¼ãƒ ã®ã‚¯ã‚¤ãƒƒã‚¯è¨˜éŒ²ã‚’éè¡¨ç¤º */
#home .dashboard-quick { display: none !important; }

/* ã‚¹ãƒãƒ›æœ€é©åŒ– */
@media (max-width: 480px) {
  .fab-container { bottom: 20px; right: 8px; }
  .fab-main { width: 56px; height: 56px; font-size: 26px; }
  .fab-sub { padding: 10px 16px; }
  .fab-sub .fab-label { font-size: 13px; }
}
</style>

<div class="fab-overlay" id="fabOverlay"></div>
<div class="fab-container" id="fabContainer">
  <button class="fab-main" id="fabMain" type="button" aria-label="ã‚¯ã‚¤ãƒƒã‚¯è¨˜éŒ²">ï¼‹</button>
  <div class="fab-menu" id="fabMenu">
    <button class="fab-sub" id="fabActivity" type="button">
      <span class="fab-icon">â±ï¸</span>
      <span class="fab-label">è¡Œå‹•ã‚’è¨˜éŒ²</span>
    </button>
    <button class="fab-sub" id="fabMoney" type="button">
      <span class="fab-icon">ğŸ’°</span>
      <span class="fab-label">æ”¯å‡ºã‚’è¨˜éŒ²</span>
    </button>
  </div>
</div>

<script>
/* ===== FAB Logic ===== */
(function(){
  'use strict';
  var fabMain = document.getElementById('fabMain');
  var fabMenu = document.getElementById('fabMenu');
  var fabOverlay = document.getElementById('fabOverlay');
  var fabActivity = document.getElementById('fabActivity');
  var fabMoney = document.getElementById('fabMoney');
  if(!fabMain || !fabMenu || !fabOverlay) return;

  var isOpen = false;

  function toggleFab() {
    isOpen = !isOpen;
    fabMain.classList.toggle('open', isOpen);
    fabMenu.classList.toggle('open', isOpen);
    fabOverlay.classList.toggle('open', isOpen);
  }
  function closeFab() {
    if (!isOpen) return;
    isOpen = false;
    fabMain.classList.remove('open');
    fabMenu.classList.remove('open');
    fabOverlay.classList.remove('open');
  }

  fabMain.addEventListener('click', function(e) {
    e.stopPropagation();
    toggleFab();
  });
  fabOverlay.addEventListener('click', closeFab);

  fabActivity.addEventListener('click', function() {
    closeFab();
    if (typeof window.setQuickRecordMode === 'function') window.setQuickRecordMode('activity');
    if (typeof window.openQuickRecordModal === 'function') {
      window.openQuickRecordModal();
    } else if (typeof window.switchTab === 'function') {
      window.switchTab('activity');
    }
  });

  fabMoney.addEventListener('click', function() {
    closeFab();
    if (typeof window.setQuickRecordMode === 'function') window.setQuickRecordMode('money');
    if (typeof window.openQuickRecordModal === 'function') {
      window.openQuickRecordModal();
    } else if (typeof window.switchTab === 'function') {
      window.switchTab('money');
    }
  });

  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') closeFab();
  });

  console.log('âœ… FAB (Floating Action Button) åˆæœŸåŒ–å®Œäº†');
})();
</script>


<!-- ===== Fix: ã‚¹ãƒãƒ›ã§ä¿å­˜ãƒœã‚¿ãƒ³ãŒåå¿œã—ãªã„å¯¾ç­– (savefix) ===== -->
<script>
(function(){
  'use strict';

  // iOS Safari / Android WebView ã§ click ãŒç™ºç«ã—ã¥ã‚‰ã„ã‚±ãƒ¼ã‚¹ã®å¯¾ç­–
  // 1) touchstart ã‚’ç©ºã§ç™»éŒ²ï¼ˆã‚¿ãƒƒãƒ—åˆ¤å®šã®å®‰å®šåŒ–ï¼‰
  document.addEventListener('touchstart', function(){}, {passive:true});

  // 2) touchend ã§ button/a/role=button ã‚’æ¤œå‡ºã—ã¦ click ã‚’å¼·åˆ¶ï¼ˆâ€»æ—¢å­˜ onclick ã‚’å£Šã•ãªã„ï¼‰
  // 2) touchend ã§å¯¾è±¡è¦ç´ ã ã‘ click ã‚’å¼·åˆ¶ï¼ˆâ€» ã®ã¿ï¼‰
//    ã•ã‚‰ã«ã€Œå¼·åˆ¶clickã®ç›´å¾Œã«OSå´clickãŒæ¥ã‚‹ã€äºŒé‡ç™ºç«ã‚’æŠ‘æ­¢ã™ã‚‹
document.addEventListener('touchend', function(e){
  const t = e.target;
  // å¯¾è±¡ã¯ ã‚’ä»˜ã‘ãŸè¦ç´ ã®ã¿ã«é™å®š
  const el = t?.closest?.('[data-force-click="1"]');
  if(!el) return;
  if(el.disabled || el.getAttribute('aria-disabled') === 'true') return;

  const now = Date.now();
  const last = Number(el.dataset.__touchClickTs || 0);
  if(now - last < 300) return;
  el.dataset.__touchClickTs = String(now);

  // ã€Œã“ã®ã‚¯ãƒªãƒƒã‚¯ã¯å¼·åˆ¶clickã§ã™ã€ãƒ•ãƒ©ã‚°
  el.dataset.__forcedClick = '1';

  // iOS ãªã©ã§ã€Œå…¥åŠ›æ¬„ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ä¸­ã ã¨ãƒœã‚¿ãƒ³tapãŒå…ˆã«blurã ã‘ã§çµ‚ã‚ã‚‹ã€ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€å…ˆã« blur ã—ã¦ã‹ã‚‰ click
  try {
    const ae = document.activeElement;
    if (ae && (ae.tagName === 'INPUT' || ae.tagName === 'TEXTAREA')) ae.blur();
  } catch(_) {}

  try {
    requestAnimationFrame(() => { try { el.click(); } catch(_) {} });
  } catch(_) {
    try { el.click(); } catch(_) {}
  }}, { passive:true });

// click ã‚’ã‚­ãƒ£ãƒ—ãƒãƒ£æ®µéšã§ç›£è¦–ã—ã€
// ã€Œtouchendå¼·åˆ¶clickã®ç›´å¾Œã«æ¥ã‚‹OSå´clickã€ã ã‘ã‚’ãƒ–ãƒ­ãƒƒã‚¯ã™ã‚‹
document.addEventListener('click', function(e){
  const t = e.target;
  const el = t?.closest?.('[data-force-click="1"]');
  if(!el) return;

  // å¼·åˆ¶clickãã®ã‚‚ã®ã¯é€šã—ã¦ã€ãƒ•ãƒ©ã‚°ã‚’å³ã‚¯ãƒªã‚¢
  if(el.dataset.__forcedClick === '1'){
    delete el.dataset.__forcedClick;
    return;
  }

  const lastTouch = Number(el.dataset.__touchClickTs || 0);
  if(lastTouch && (Date.now() - lastTouch) < 600){
    e.preventDefault();
    e.stopPropagation();
    if (typeof e.stopImmediatePropagation === 'function') e.stopImmediatePropagation();
  }
}, true);
})();
</script>



<script>
/* ===== Quick Record: windowå…¬é–‹ãƒ–ãƒªãƒƒã‚¸ï¼ˆå®‰å…¨ãƒ‘ãƒƒãƒï¼‰ ===== */
(function(){
  'use strict';

  // æ—¢å­˜é–¢æ•°ãŒã‚ã‚‹å‰æã§ã€æŒ™å‹•ã‚’å¤‰ãˆãšã«ã€Œå¤–éƒ¨ã‹ã‚‰è¦‹ãˆã‚‹çŠ¶æ…‹ã€ã‚’å¢—ã‚„ã™
  const origOpen = window.openQuickRecordModal;
  const origSelect = window.selectQuickRecordCategory;
  const origSave = window.saveQuickRecord;

  if (typeof origOpen === 'function') {
    window.openQuickRecordModal = function(categoryName, categoryEmoji){
      // ãƒ¢ãƒ¼ãƒ‰ã¯æ—¢å­˜å®Ÿè£…ãŒå†…éƒ¨ã§æŒã¤ã®ã§ã€ã“ã¡ã‚‰ã¯ã€Œæœ€å¾Œã«è¦‹ãˆãŸå€¤ã€ã‚’ä¿æŒ
      try { window.qrSelectedCategory = null; window.qrSelectedEmoji = null; } catch(e) {}
      return origOpen.apply(this, arguments);
    };
  }

  if (typeof origSelect === 'function') {
    window.selectQuickRecordCategory = function(name, emoji){
      // é¸æŠçŠ¶æ…‹ã‚’ window ã«ã‚‚åæ˜ ï¼ˆãƒ‡ãƒãƒƒã‚°/ä»–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«é€£æºç”¨ï¼‰
      try { window.qrSelectedCategory = name; window.qrSelectedEmoji = emoji; } catch(e) {}
      return origSelect.apply(this, arguments);
    };
  }

  if (typeof origSave === 'function') {
    window.saveQuickRecord = function(){
      const r = origSave.apply(this, arguments);

      // ä¿å­˜å¾Œã«åŒæœŸç³»ãŒèµ°ã‚‰ãªã„ç«¯æœ«ç”¨ã®ä¿é™ºï¼ˆæ—¢å­˜ã®v39.9åŒæœŸãŒã‚ã£ã¦ã‚‚ç„¡å®³ï¼‰
      try {
        if (typeof window.updateDashboard === 'function') window.updateDashboard();
        if (typeof window.renderActivityLogs === 'function') window.renderActivityLogs();
        if (typeof window.renderActivities === 'function') window.renderActivities();
      } catch(e) {}

      return r;
    };
  }

  console.log('âœ… Quick Record windowå…¬é–‹ãƒ–ãƒªãƒƒã‚¸ã‚’é©ç”¨');
})();
</script>


<script>
// --- DEBUGï¼ˆå¿…è¦ãªã¨ãã ã‘ã‚³ãƒ¡ãƒ³ãƒˆè§£é™¤ï¼‰---
// document.querySelector('.qr-save-btn')?.addEventListener('click', function(){
//   alert('clickã‚¤ãƒ™ãƒ³ãƒˆç™ºç«: category=' + (window.qrSelectedCategory || 'null'));
// }, true);
</script>


<script>
// v8: ã‚°ãƒ­ãƒ¼ãƒãƒ«ä¿å­˜ä¸­ãƒ•ãƒ©ã‚°
window.__qrSaving = false;
</script>


<script>
// v9: ãƒ¢ãƒ¼ãƒ€ãƒ«è¡¨ç¤ºä¸­ã¯FABã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ã‚’ç„¡åŠ¹åŒ–ï¼ˆã‚¿ãƒƒãƒ—å¥ªå–é˜²æ­¢ï¼‰
(function(){
  function markOpen(){ try{ document.body.classList.add('qr-open'); }catch(_){} }
  function markClose(){ try{ document.body.classList.remove('qr-open'); }catch(_){} }

  try{
    if(typeof window.openQuickRecordModal === 'function' && !window.openQuickRecordModal.__qrWrappedV9){
      var origOpen = window.openQuickRecordModal;
      window.openQuickRecordModal = function(){
        markOpen();
        return origOpen.apply(this, arguments);
      };
      window.openQuickRecordModal.__qrWrappedV9 = true;
    }
  }catch(_){}

  ['closeQuickRecordModal','closeQRModal','closeQuickRecord'].forEach(function(fn){
    try{
      if(typeof window[fn] === 'function' && !window[fn].__qrWrappedV9){
        var orig = window[fn];
        window[fn] = function(){
          markClose();
          return orig.apply(this, arguments);
        };
        window[fn].__qrWrappedV9 = true;
      }
    }catch(_){}
  });

  document.addEventListener('click', function(e){
    var t = e.target;
    if(!t) return;
    var btn = t.closest ? t.closest('.qr-cancel-btn') : null;
    if(btn) markClose();
  }, true);
})();
</script>


<script>
/* ===== Quick Record: äºŒé‡ä¿å­˜é˜²æ­¢ãƒ‘ãƒƒãƒ (v9) ===== */
(function(){
  'use strict';

  var isSaving = false; // ä¿å­˜ä¸­ãƒ•ãƒ©ã‚°

  // å…ƒã®ä¿å­˜é–¢æ•°ã‚’ãƒ©ãƒƒãƒ—ã—ã¦äºŒé‡å®Ÿè¡Œã‚’é˜»æ­¢
  var originalSave = window.saveQuickRecord;
  if (typeof originalSave === 'function' && !originalSave.__wrappedV9) {
    window.saveQuickRecord = function() {
      if (isSaving) return;

      // ã‚«ãƒ†ã‚´ãƒªæœªé¸æŠãƒã‚§ãƒƒã‚¯ï¼ˆwindow / ãƒ­ãƒ¼ã‚«ãƒ«ä¸¡å¯¾å¿œï¼‰
      var cat = null;
      try {
        cat = window.qrSelectedCategory || (typeof qrSelectedCategory !== 'undefined' ? qrSelectedCategory : null);
      } catch(_) {}
      if (!cat) {
        try { alert('âŒ ã‚«ãƒ†ã‚´ãƒªã‚’é¸æŠã—ã¦ãã ã•ã„'); } catch(_) {}
        return;
      }

      isSaving = true;
      try {
        var r = originalSave.apply(this, arguments);
        // ãƒ¢ãƒ¼ãƒ€ãƒ«ãŒé–‰ã˜ã‚‹ã¾ã§ã®çŒ¶äºˆ
        setTimeout(function(){ isSaving = false; }, 1000);
        return r;
      } catch (e) {
        isSaving = false;
        console.error(e);
      }
    };
    window.saveQuickRecord.__wrappedV9 = true;
  }

  // ã‚¹ãƒãƒ›ã§åå¿œã‚’è‰¯ãã™ã‚‹ãŸã‚ã®å˜ä¸€ã®ãƒªã‚¹ãƒŠãƒ¼ï¼ˆã‚­ãƒ£ãƒ—ãƒãƒ£ç›¸ã§1å›ã ã‘æ‹¾ã†ï¼‰
  // ã“ã“ã§ preventDefault ã—ã¦ã€OSå´clickç­‰ã®äºŒé‡ç™ºç«ã‚’æŠ‘æ­¢
  document.addEventListener('touchend', function(e) {
    var btn = e.target && e.target.closest ? e.target.closest('.qr-save-btn') : null;
    if (!btn) return;

    try { e.preventDefault(); } catch(_) {}
    try { e.stopPropagation(); } catch(_) {}
    try { if(e.stopImmediatePropagation) e.stopImmediatePropagation(); } catch(_) {}

    // å…¥åŠ›æ¬„ã®ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å¤–ã™ï¼ˆã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚’é–‰ã˜ã‚‹ï¼‰
    try { if (document.activeElement) document.activeElement.blur(); } catch(_) {}

    try { window.saveQuickRecord && window.saveQuickRecord(); } catch(err) { console.error(err); }
  }, { capture: true, passive: false });
})();
</script>










<script>
/* ===== v41.2 Final Shift-JIS Integration (Android Absolute Fix) ===== */
(function(){
  'use strict';

  function convertToSJIS(str) {
    if (!window.Encoding) {
      console.error('Encoding.js is not loaded');
      return new TextEncoder().encode(str);
    }
    var unicodeArray = Encoding.stringToCode(str);
    var sjisArray = Encoding.convert(unicodeArray, 'SJIS', 'UNICODE');
    return new Uint8Array(sjisArray);
  }

  var _originalDownload = window.downloadTextFile;

  window.downloadTextFile = function(filename, text, mime) {
    var name = String(filename || '');
    var isCSV = (mime === 'text/csv') || (/\.csv$/i.test(name));

    if (isCSV) {
      try {
        var content = String(text || '').replace(/\r?\n/g, '\r\n');
        var sjisBytes = convertToSJIS(content);

        var blob = new Blob([sjisBytes], { type: 'application/octet-stream' });
        var url = URL.createObjectURL(blob);
        var a = document.createElement('a');

        a.href = url;
        a.download = filename || 'export.csv';
        document.body.appendChild(a);
        a.click();

        setTimeout(function(){
          try { document.body.removeChild(a); } catch(_) {}
          URL.revokeObjectURL(url);
        }, 1000);

        console.log('âœ… CSVã‚’Shift-JISãƒã‚¤ãƒŠãƒªã§å‡ºåŠ›ã—ã¾ã—ãŸ');
        return;
      } catch (e) {
        console.error('SJIS conversion failed:', e);
      }
    }

    if (typeof _originalDownload === 'function') {
      return _originalDownload(filename, text, mime);
    }
  };

  console.log('ğŸš€ v41.2 Shift-JISçµ±åˆãƒ‘ãƒƒãƒãŒæœ‰åŠ¹ã«ãªã‚Šã¾ã—ãŸ');
})();
</script>

</body>
</html>
